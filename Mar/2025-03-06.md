# RDS

- 데이터베이스의 필요성
    - 데이터의 저장 및 관리
    - 관계형 데이터베이스와 NoSQL 데이터베이스
- AWS에서의 데이터베이스
    - 온프레미스처럼 EC2 안에 직접 설치
    - RDS를 사용 - 운영 및 관리는 물론 백업과 다중화까지
- `Fail-over`: 장애 발생 시 복제본으로 마이그레이션 및 싱크 동작 하는 과정
    - RDS에서는 Master-Slave(Primary-StandBy) 방식을 사용
    - 과정 중에 순단 현상이 발생함
- `AuroraDB`: 오토 스케일링 기능이 추가된 RDS
    - 분산 스토리지 아키텍처
    - IOPS 성능 자동조절
- RDS는 EBS를 통해 IOPS 제한 - gp2, gp3 등 최소 3000 이상
- RDS 사용 시 고가용성 확보하는 법
    - 다중 AZ - RDS를 추가로 생성하여 문제 발생 시 대체(`yml`에 Primary, StandBy 인스턴스 명시 필요)

# ELB

- 네트워크 트래픽을 하나 이상의 서버나 장비로 분산하기 위해 사용되는 기술
- Scale Up: CPU/RAM/Disk 성능, 대역폭 등을 증가시키는 것 - 고성능의 서버로 변경
- Scale Out: 부하를 처리할 서버 수를 늘리는 것

## Round-Robin

- 로드 밸런서에서 서버 선택 시, 다음 순차적으로 서버를 선택하는 방식
- 3개의 서버가 있는 경우, 1-2-3번 서버 순으로 연결시키는 것
- 세션 문제가 발생할 우려 → 세션 클러스터링(`ElastiCache`)

## Sticky Session(Hash)

- 로드 밸런서에서 서버 선택 시, 클라이언트와 한번 연결되면, 이후에 항상 같은 서버로 연결하는 방식

## Least Connection

- 로드 밸런서에서 서버 선택 시, 연결 수가 가장 적은 서버를 선택하는 방식

## Response Time

- 로드 밸런서에서 서버 선택 시, 응답속도가 가장 빠른 서버를 선택하는 방식

## 유형

- ALB(Application Load Balancer)
    - Application Layer에 속하는 패킷 처리
    - HTTP/HTTPS 프로토콜
    - 규칙 설정 - 헤더, 경로 등을 기준으로 대상 그룹 선택
- NLB(Network Load Balancer)
    - Transport Layer에 속하는 패킷 처리
    - TCP 프로토콜
    - 트래픽 처리에 최적화
    - 공인 IP 고정할 수 있음
- CLB(Classic Load Balancer)
    - Network, Transport Layer에 속하는 패킷 처리
    - 과거 방식으로, 호환성을 위해 유지되는 상태

## 옵션

- 인터넷 트래픽용
    - 인터넷을 통해 ELB에 접근하는 경우
    - ELB가 IP 쌍을 가지므로 Private IP 클라이언트로도 사용 가능
- 내부 네트워크 트래픽용
    - 내부 네트워크에서 ELB에 접근하는 경우
    - 인터넷을 안거치고 연결되는 경우나 VPN을 이용해 Private IP로 통신하는 경우

## 특징

- 헬스체크 서비스
    - ELB가 연결할 서버들의 상태를 상시 체크
    - 비정상 상태인 서버로 트래픽 전달을 하지 않는다
    - ELB → 서버로 요청을 전달해 응답을 받음으로써 처리되므로 보안그룹 설정을 잘 해줘야 함
- 고가용성 지원
    - ELB를 서로 다른 AZ 서브넷에 생성하여 트래픽을 처리
- 자동확장 동작 방식
    - 트래픽 수에 따라 서버 수 조절
    - 자동 확장 그룹: 확장/축소에 사용될 EC2 인스턴스의 논리적 집합
    - 최소 용량: 항상 유지할 인스턴스 개수
    - 필요 크기: 평상 시 유지하는 인스턴스 개수 ≥ 최소 용량
    - 최대 크기: 확장 시 늘어날 수 있는 인스턴스 개수
- 인스턴스 개수 조정 옵션
    1. 항상 지정된 수의 인스턴스 유지: 자동확장 그룹에서 지정한 인스턴스 개수 유지
    2. 수동 조정: 사용자가 직접 그룹의 인스턴스 개수 조정
    3. 일정 기반 조정: 특정 시간대에 인스턴스 확장, 그 외엔 축소
    4. 온디맨드 기반 조정: EC2 지표를 기반으로 조정
- 이벤트성 부하분산 방법
    1. Pre-Warming 신청한다 = 로드 밸런서 용량을 미리 확보하는 것
    2. 정적으로 추가 서버를 올린다
    3. 자동확장 기능을 활용한다

<aside>
❗

로드 밸런서의 자동확장 기능만 믿으면 안된다!!!

</aside>

# AWS Lambda

- **서버 관리 없이 코드를 실행할 수 있는 AWS의 서버리스 컴퓨팅 서비스**
- 핵심은 **이벤트 기반**이라는 것
- 최대 메모리 할당: 3008MB
- 함수 제한 시간: 15분
- 배포 패키지 크기: 압축 해제 시 250MB
- **서버리스 실행:** 인프라를 직접 관리하지 않고, 코드를 업로드하면 AWS가 자동으로 실행 환경을 제공하여 코드 실행을 처리
- **이벤트 기반 아키텍처:** `S3`, `API Gateway`, `DynamoDB` 등 다양한 AWS 서비스의 이벤트에 반응하여 자동으로 실행
- **자동 확장:** 요청 수에 따라 자동으로 확장되므로, 트래픽 변화에 유연하게 대응할 수 있다
- **비용 효율성:** 실제 코드 실행 시간에 대해서만 과금되므로, 사용하지 않을 때는 비용이 발생하지 않는다